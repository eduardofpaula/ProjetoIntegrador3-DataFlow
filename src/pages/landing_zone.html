<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--VUE IMPORT-->
    <script src="../utils/vue.js"></script>
    <!--CSS only-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <!--JS Popper-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="../assets/style/style_default.css" />
    <link rel="stylesheet" href="../assets/style/landing_zone.css" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <script src="../utils/mockup.js"></script>

    <title>Landing Zone</title>
  </head>

  <body>
    <nav id="menu-x">
      <ul>
        <img src="../assets/images/logoDomRock.png" alt="" />

        <li class="semiBold600">
          <a href="#">
            <span class="material-icons">account_circle</span>
            Meu Perfil
          </a>
        </li>

        <li class="semiBold600">
          <a href="/src/pages/upload-csv.html">
            <span class="material-icons">upload_file</span>
            Importar Novo CSV
          </a>
        </li>

        <li class="semiBold600">
          <a href="/public/index.html">
            <span class="material-icons">home</span>
            Home
          </a>
        </li>
      </ul>
    </nav>
    <main>
      <div id="app">
        <h2 v-text="nameFile"></h2>
        <table>
          <thead>
            <tr>
              <!--cabeçalho da tabela-->
              <th v-for="(head, index) in headTabela" :key="index">
                {{ head }}
              </th>
            </tr>
          </thead>
          <tbody>
            <!--coluna nome-->
            <tr v-for="(item, index) in data" :key="index">
              <td>
                <input type="checkbox" value="true" checked  v-model="item.ativo" />
              </td>
              <td>{{ item.nome }}</td>
              <td>
                <!--coluna tipo-->
                <select v-model="item.tipo">
                  <option value="" disabled>Selecione um Tipo</option>
                  <option v-for="(tipo, index) in tipoDadoTabela" :key="index">
                    {{ tipo }}
                  </option>
                </select>
              </td>
              <!--coluna obrigatoprio-->
              <td>
                <input type="checkbox" value="" v-model="item.obrigatorio" />
              </td>
              <!--coluna tamanho maximo-->
              <td><input type="text" v-model="item.tamanhoMaximo" /></td>
              <!--coluna valor padrão-->
              <td><input type="text" v-model="item.valorPadrao" /></td>
              <!--coluna descrição-->
              <td><input type="text" v-model="item.descricao" /></td>
            </tr>
          </tbody>
        </table>
        <button class="btn" @click="adicionarMetadados()">Salvar</button>
      </div>
    </main>

    <script>
      //import dos dados ficticios

      mock();

      let dados = JSON.parse(localStorage.getItem("dadosUpload"));

      console.log(dados.response.columns);

      let test = []; // referenciar a variavel que vai receber o objeto e desmembrar com um for

      dados.response.columns.forEach((coluna) => {
        test.push({ nome: coluna.nome, ativo: true });
      });

      // instancia do Vue

      const vm = new Vue({
        el: "#app",
        data: {
          // dados tabela
          nameFile: dados.response.fileName,
          headTabela: [
            "Ativo",
            "Nome",
            "Tipo de Dado",
            "Obrigatório",
            "Tamanho Máximo",
            "Valor Padrão",
            "Descrição",
          ],
          tipoDadoTabela: [
            "Int",
            "Decimal",
            "Boolean",
            "String",
            "Date",
            "Hour",
            "Date Time",
          ],
          data: test,
        },
        methods: {
          adicionarMetadados() {
            let metadados = [];

            this.data.forEach((item) => {
              console.log(item.ativo);
              metadados.push({

                ativo: item.ativo,
                nome: item.nome,
                valorPadrao: item.valorPadrao,
                descricao: item.descricao,
                restricoes: {
                  obrigatorio: item.obrigatorio,
                  tamanhoMaximo: item.tamanhoMaximo,
                },
                tipo: item.tipo,
              });
            });
            console.log(metadados); // Aqui você pode fazer o que deseja com os objetos gerados
          },
        },
      });
    </script>
  </body>
</html>
